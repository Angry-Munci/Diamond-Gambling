<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>💎 Diamond Slots Multiplayer</title>
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-database.js"></script>
<style>
/* Same style as your old version shortened here for clarity */
body {background: radial-gradient(circle,#0b001f,#000);font-family:Orbitron,sans-serif;text-align:center;color:white}
.slot{display:inline-block;width:100px;height:100px;line-height:100px;margin:10px;font-size:2em;border:3px solid #8f4aff;border-radius:15px}
#leaderboard{background:rgba(20,0,40,.8);padding:10px;border-radius:10px;width:300px;margin:20px auto}
</style>
</head>
<body>
<h1>💎 Diamond Slots Multiplayer 💎</h1>

<div id="loginDiv">
  <input id="email" placeholder="Email"><br>
  <input id="password" type="password" placeholder="Password"><br>
  <button onclick="login()">Login / Register</button>
</div>

<div id="gameDiv" style="display:none;">
  <div id="diamondDisplay"></div>
  <div id="slots">
    <div class="slot" id="slot1">❔</div>
    <div class="slot" id="slot2">❔</div>
    <div class="slot" id="slot3">❔</div>
  </div>
  <br>
  <button id="spinBtn">🎰 SPIN</button>
  <h3 id="result"></h3>

  <div id="leaderboard">
    <h2>🏆 Leaderboard 🏆</h2>
    <ol id="leaderboardList"></ol>
  </div>
</div>

<script>
// === 1️⃣ FIREBASE CONFIG ===
const firebaseConfig = {
  // paste your config here
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

let user = null;
let diamonds = 1000;

// === 2️⃣ LOGIN OR REGISTER ===
async function login() {
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  try {
    const userCred = await auth.signInWithEmailAndPassword(email, password);
    user = userCred.user;
    startGame();
  } catch (e) {
    if (e.code === 'auth/user-not-found') {
      const newUser = await auth.createUserWithEmailAndPassword(email, password);
      user = newUser.user;
      await db.ref('players/'+user.uid).set({ email, diamonds });
      startGame();
    } else {
      alert(e.message);
    }
  }
}

// === 3️⃣ START GAME ===
function startGame() {
  document.getElementById('loginDiv').style.display='none';
  document.getElementById('gameDiv').style.display='block';
  db.ref('players/'+user.uid+'/diamonds').on('value', snap=>{
    diamonds = snap.val() || 0;
    updateDisplay();
  });
  loadLeaderboard();
}

function updateDisplay() {
  document.getElementById('diamondDisplay').innerText = `💎 Diamonds: ${diamonds}`;
}

// === 4️⃣ SPIN ===
document.getElementById('spinBtn').onclick = ()=>{
  if (diamonds < 50) return alert("Not enough diamonds!");
  diamonds -= 50;
  const s=["💎","🍒","🍋","🔔","7️⃣","⭐","🔥"];
  const r1=s[Math.floor(Math.random()*s.length)];
  const r2=s[Math.floor(Math.random()*s.length)];
  const r3=s[Math.floor(Math.random()*s.length)];
  slot1.textContent=r1;slot2.textContent=r2;slot3.textContent=r3;
  if (r1===r2 && r2===r3){
    let reward=500;
    diamonds+=reward;
    result.innerText=`🎉 You won +${reward}!`;
  }else{
    result.innerText="😢 Try again!";
  }
  db.ref('players/'+user.uid+'/diamonds').set(diamonds);
  loadLeaderboard();
};

// === 5️⃣ LEADERBOARD ===
function loadLeaderboard(){
  db.ref('players').orderByChild('diamonds').limitToLast(10).once('value', snap=>{
    const list=document.getElementById('leaderboardList');
    let arr=[];
    snap.forEach(c=>arr.push(c.val()));
    arr.reverse();
    list.innerHTML=arr.map(p=>`<li>${p.email.split('@')[0]} — ${p.diamonds} 💎</li>`).join('');
  });
}
</script>
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyDz9r72XqaOc_UIo4KgV5G2OUSRKX0VWzQ",
    authDomain: "gambling-slot.firebaseapp.com",
    projectId: "gambling-slot",
    storageBucket: "gambling-slot.firebasestorage.app",
    messagingSenderId: "61827285741",
    appId: "1:61827285741:web:f037adf70a2994bd70c2e4"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
</script>
</body>
</html>
